[2024-11-22T00:15:31.159+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-11-22T00:15:31.172+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_stock_prediction.get_weather_forecast scheduled__2024-11-21T00:00:00+00:00 [queued]>
[2024-11-22T00:15:31.181+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_stock_prediction.get_weather_forecast scheduled__2024-11-21T00:00:00+00:00 [queued]>
[2024-11-22T00:15:31.181+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-11-22T00:15:31.192+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): get_weather_forecast> on 2024-11-21 00:00:00+00:00
[2024-11-22T00:15:31.200+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=10483) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-11-22T00:15:31.201+0000] {standard_task_runner.py:72} INFO - Started process 10547 to run task
[2024-11-22T00:15:31.202+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_stock_prediction', 'get_weather_forecast', 'scheduled__2024-11-21T00:00:00+00:00', '--job-id', '312', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpn2atjqyb']
[2024-11-22T00:15:31.203+0000] {standard_task_runner.py:105} INFO - Job 312: Subtask get_weather_forecast
[2024-11-22T00:15:31.263+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_stock_prediction.get_weather_forecast scheduled__2024-11-21T00:00:00+00:00 [running]> on host cba1e82f0ade
[2024-11-22T00:15:31.331+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_stock_prediction' AIRFLOW_CTX_TASK_ID='get_weather_forecast' AIRFLOW_CTX_EXECUTION_DATE='2024-11-21T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-11-21T00:00:00+00:00'
[2024-11-22T00:15:31.333+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-11-22T00:15:31.333+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-11-22T00:15:31.334+0000] {logging_mixin.py:190} INFO - Current task name:get_weather_forecast state:running start_date:2024-11-22 00:15:31.172756+00:00
[2024-11-22T00:15:31.334+0000] {logging_mixin.py:190} INFO - Dag name:weather_stock_prediction and current dag run status:running
[2024-11-22T00:15:31.334+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-11-22T00:15:31.475+0000] {logging_mixin.py:190} INFO - {'city': {'id': 5391959, 'name': 'San Francisco', 'coord': {'lon': -122.4194, 'lat': 37.7749}, 'country': 'US', 'population': 805235, 'timezone': -28800}, 'cod': '200', 'message': 5.1081953, 'cnt': 16, 'list': [{'dt': 1732215600, 'sunrise': 1732201024, 'sunset': 1732236883, 'temp': {'day': 15.35, 'min': 14.22, 'max': 16.25, 'night': 14.87, 'eve': 16.14, 'morn': 14.27}, 'feels_like': {'day': 14.93, 'night': 14.58, 'eve': 16, 'morn': 13.71}, 'pressure': 1018, 'humidity': 76, 'weather': [{'id': 501, 'main': 'Rain', 'description': 'moderate rain', 'icon': '10d'}], 'speed': 10.89, 'deg': 168, 'gust': 18.52, 'clouds': 100, 'pop': 0.81, 'rain': 8.48}, {'dt': 1732302000, 'sunrise': 1732287487, 'sunset': 1732323253, 'temp': {'day': 15.65, 'min': 12.78, 'max': 15.65, 'night': 12.78, 'eve': 14.35, 'morn': 15.04}, 'feels_like': {'day': 15.36, 'night': 12.46, 'eve': 14.3, 'morn': 14.74}, 'pressure': 1013, 'humidity': 80, 'weather': [{'id': 502, 'main': 'Rain', 'description': 'heavy intensity rain', 'icon': '10d'}], 'speed': 11.3, 'deg': 176, 'gust': 19.56, 'clouds': 100, 'pop': 1, 'rain': 34.58}, {'dt': 1732388400, 'sunrise': 1732373949, 'sunset': 1732409626, 'temp': {'day': 13.32, 'min': 11.26, 'max': 13.49, 'night': 11.26, 'eve': 12.26, 'morn': 12.13}, 'feels_like': {'day': 12.72, 'night': 10.63, 'eve': 11.53, 'morn': 11.77}, 'pressure': 1015, 'humidity': 77, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'speed': 4.54, 'deg': 241, 'gust': 6.39, 'clouds': 4, 'pop': 0.87, 'rain': 1.98}, {'dt': 1732474800, 'sunrise': 1732460411, 'sunset': 1732496000, 'temp': {'day': 10.92, 'min': 10.31, 'max': 13.66, 'night': 12.56, 'eve': 13.6, 'morn': 10.33}, 'feels_like': {'day': 10, 'night': 11.91, 'eve': 12.74, 'morn': 9.59}, 'pressure': 1018, 'humidity': 74, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'speed': 5.61, 'deg': 167, 'gust': 10.2, 'clouds': 100, 'pop': 0.36, 'rain': 0.72}, {'dt': 1732561200, 'sunrise': 1732546872, 'sunset': 1732582376, 'temp': {'day': 11.32, 'min': 11.11, 'max': 12.09, 'night': 11.11, 'eve': 11.24, 'morn': 11.85}, 'feels_like': {'day': 10.75, 'night': 10.65, 'eve': 10.74, 'morn': 11.23}, 'pressure': 1019, 'humidity': 86, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'speed': 4.55, 'deg': 141, 'gust': 8.97, 'clouds': 100, 'pop': 0.97, 'rain': 8.66}, {'dt': 1732647600, 'sunrise': 1732633333, 'sunset': 1732668754, 'temp': {'day': 12.08, 'min': 10.72, 'max': 13.12, 'night': 11.65, 'eve': 13.03, 'morn': 11.11}, 'feels_like': {'day': 11.41, 'night': 10.86, 'eve': 12.22, 'morn': 10.57}, 'pressure': 1022, 'humidity': 79, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'speed': 2.51, 'deg': 38, 'gust': 2.97, 'clouds': 100, 'pop': 0.35, 'rain': 0.4}, {'dt': 1732734000, 'sunrise': 1732719793, 'sunset': 1732755134, 'temp': {'day': 11.17, 'min': 9.73, 'max': 13.01, 'night': 10.91, 'eve': 13.01, 'morn': 10.24}, 'feels_like': {'day': 9.88, 'night': 9.62, 'eve': 11.75, 'morn': 9.3}, 'pressure': 1022, 'humidity': 59, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'speed': 3.99, 'deg': 39, 'gust': 6.67, 'clouds': 99, 'pop': 0}, {'dt': 1732820400, 'sunrise': 1732806252, 'sunset': 1732841516, 'temp': {'day': 10.61, 'min': 8.59, 'max': 13.61, 'night': 10.6, 'eve': 13.61, 'morn': 9.27}, 'feels_like': {'day': 9.27, 'night': 9.18, 'eve': 12.28, 'morn': 7.3}, 'pressure': 1020, 'humidity': 59, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'sky is clear', 'icon': '01d'}], 'speed': 4.48, 'deg': 54, 'gust': 6.68, 'clouds': 2, 'pop': 0}, {'dt': 1732906800, 'sunrise': 1732892711, 'sunset': 1732927900, 'temp': {'day': 10.6, 'min': 8.54, 'max': 14.2, 'night': 11.15, 'eve': 14.2, 'morn': 9.22}, 'feels_like': {'day': 9.28, 'night': 9.84, 'eve': 12.96, 'morn': 7.23}, 'pressure': 1019, 'humidity': 60, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'sky is clear', 'icon': '01d'}], 'speed': 4.54, 'deg': 43, 'gust': 5.84, 'clouds': 0, 'pop': 0}, {'dt': 1732993200, 'sunrise': 1732979168, 'sunset': 1733014286, 'temp': {'day': 11.16, 'min': 9.01, 'max': 14.48, 'night': 11.68, 'eve': 14.48, 'morn': 9.71}, 'feels_like': {'day': 9.82, 'night': 10.44, 'eve': 13.32, 'morn': 7.68}, 'pressure': 1022, 'humidity': 57, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'sky is clear', 'icon': '01d'}], 'speed': 3.92, 'deg': 49, 'gust': 5.03, 'clouds': 0, 'pop': 0}, {'dt': 1733079600, 'sunrise': 1733065625, 'sunset': 1733100674, 'temp': {'day': 11.32, 'min': 9.8, 'max': 13.81, 'night': 11.74, 'eve': 13.81, 'morn': 10.39}, 'feels_like': {'day': 9.89, 'night': 10.54, 'eve': 12.6, 'morn': 9}, 'pressure': 1022, 'humidity': 53, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'speed': 3.45, 'deg': 42, 'gust': 3.91, 'clouds': 100, 'pop': 0}, {'dt': 1733166000, 'sunrise': 1733152081, 'sunset': 1733187064, 'temp': {'day': 11.78, 'min': 9.86, 'max': 14.21, 'night': 11.65, 'eve': 14.13, 'morn': 10.5}, 'feels_like': {'day': 10.37, 'night': 10.44, 'eve': 12.9, 'morn': 9.17}, 'pressure': 1021, 'humidity': 52, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'speed': 3.28, 'deg': 353, 'gust': 3.95, 'clouds': 70, 'pop': 0}, {'dt': 1733252400, 'sunrise': 1733238536, 'sunset': 1733273456, 'temp': {'day': 11.74, 'min': 9.47, 'max': 14.83, 'night': 12.03, 'eve': 14.83, 'morn': 10.12}, 'feels_like': {'day': 10.41, 'night': 10.86, 'eve': 13.67, 'morn': 8.78}, 'pressure': 1022, 'humidity': 55, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'sky is clear', 'icon': '01d'}], 'speed': 3.84, 'deg': 36, 'gust': 4.68, 'clouds': 0, 'pop': 0}, {'dt': 1733342400, 'sunrise': 1733324990, 'sunset': 1733359850, 'temp': {'day': 15, 'min': 10.01, 'max': 15.32, 'night': 12.43, 'eve': 13.56, 'morn': 10.01}, 'feels_like': {'day': 13.81, 'night': 11.16, 'eve': 12.33, 'morn': 8.66}, 'pressure': 1023, 'humidity': 48, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'sky is clear', 'icon': '01d'}], 'speed': 3.89, 'deg': 47, 'gust': 5.16, 'clouds': 0, 'pop': 0}, {'dt': 1733428800, 'sunrise': 1733411443, 'sunset': 1733446247, 'temp': {'day': 15.04, 'min': 10.26, 'max': 15.47, 'night': 12.62, 'eve': 13.57, 'morn': 10.26}, 'feels_like': {'day': 13.91, 'night': 11.45, 'eve': 12.44, 'morn': 8.88}, 'pressure': 1023, 'humidity': 50, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'sky is clear', 'icon': '01d'}], 'speed': 3.59, 'deg': 39, 'gust': 4.38, 'clouds': 0, 'pop': 0}, {'dt': 1733515200, 'sunrise': 1733497895, 'sunset': 1733532645, 'temp': {'day': 14.43, 'min': 10.52, 'max': 14.43, 'night': 11.76, 'eve': 12.49, 'morn': 10.52}, 'feels_like': {'day': 13.21, 'night': 10.85, 'eve': 11.54, 'morn': 9.19}, 'pressure': 1021, 'humidity': 49, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'speed': 2.87, 'deg': 34, 'gust': 3.18, 'clouds': 98, 'pop': 0}]}
[2024-11-22T00:15:31.485+0000] {logging_mixin.py:190} INFO - 7-day weather forecast data extracted successfully.
[2024-11-22T00:15:31.514+0000] {python.py:240} INFO - Done. Returned value was:           date  temperature  ...  humidity  wind_speed
0   2024-11-21        15.35  ...        76       10.89
1   2024-11-22        15.65  ...        80       11.30
2   2024-11-23        13.32  ...        77        4.54
3   2024-11-24        10.92  ...        74        5.61
4   2024-11-25        11.32  ...        86        4.55
5   2024-11-26        12.08  ...        79        2.51
6   2024-11-27        11.17  ...        59        3.99
7   2024-11-28        10.61  ...        59        4.48
8   2024-11-29        10.60  ...        60        4.54
9   2024-11-30        11.16  ...        57        3.92
10  2024-12-01        11.32  ...        53        3.45
11  2024-12-02        11.78  ...        52        3.28
12  2024-12-03        11.74  ...        55        3.84
13  2024-12-04        15.00  ...        48        3.89
14  2024-12-05        15.04  ...        50        3.59
15  2024-12-06        14.43  ...        49        2.87

[16 rows x 6 columns]
[2024-11-22T00:15:31.535+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-11-22T00:15:31.536+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=weather_stock_prediction, task_id=get_weather_forecast, run_id=scheduled__2024-11-21T00:00:00+00:00, execution_date=20241121T000000, start_date=20241122T001531, end_date=20241122T001531
[2024-11-22T00:15:31.539+0000] {logging_mixin.py:190} INFO - Task instance in success state
[2024-11-22T00:15:31.540+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: running
[2024-11-22T00:15:31.540+0000] {logging_mixin.py:190} INFO - Dag name:weather_stock_prediction queued_at:2024-11-22 00:15:28.563611+00:00
[2024-11-22T00:15:31.540+0000] {logging_mixin.py:190} INFO - Task hostname:cba1e82f0ade operator:PythonOperator
[2024-11-22T00:15:31.549+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2024-11-22T00:15:31.560+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-11-22T00:15:31.561+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
